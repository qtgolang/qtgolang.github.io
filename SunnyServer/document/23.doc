.版本 2
.支持库 spec

.子程序 __启动窗口_创建完毕
.局部变量 err, 文本型

' TCP服务器 是全局的【SunnyTCP服务器】类型，变量

.如果真 (TCP服务器.启动TCP服务器 (“0.0.0.0:8899”, 到整数 (&__客户进入_回调函数__参考__), 到整数 (&__客户离开_回调函数__参考__), 到整数 (&__数据到达_回调函数__参考__), 4096, 假, ) ＝ 假)
    调试输出 (“启动TCP服务器 失败：” ＋ TCP服务器.取错误 ())
    返回 ()
.如果真结束

' 其他可选命令
TCP服务器.发送数据 ()
TCP服务器.取已连接客户 ()
TCP服务器.停止服务器 ()

.子程序 __客户进入_回调函数__参考__, , 公开
.参数 服务器标识, 整数型
.参数 客户句柄, 整数型
.参数 数据指针, 整数型, , 客户的IP
.参数 指针长度, 整数型



.子程序 __客户离开_回调函数__参考__, , 公开
.参数 服务器标识, 整数型
.参数 客户句柄, 整数型
.参数 数据指针, 整数型, , 客户的IP
.参数 指针长度, 整数型



.子程序 __数据到达_回调函数__参考__, , 公开
.参数 服务器标识, 整数型
.参数 客户句柄, 整数型
.参数 客户信息_数据指针, 整数型, , 客户的IP
.参数 客户信息_指针长度, 整数型
.参数 接收数据_数据指针, 整数型, , 数据
.参数 接收数据_指针长度, 整数型
.局部变量 客户IP, 文本型
.局部变量 接收数据, 字节集

.如果真 (TCP服务器.取服务器标识 () ＝ 服务器标识)
    ' 判断来源
.如果真结束
客户IP ＝ 到文本 (指针到字节集 (客户信息_数据指针, 客户信息_指针长度))
接收数据 ＝ 指针到字节集 (接收数据_数据指针, 接收数据_指针长度)
调试输出 (“收到来着”, 客户IP, “的数据”, 接收数据)