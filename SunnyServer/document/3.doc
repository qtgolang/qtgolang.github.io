.版本 2
.支持库 spec

.子程序 __启动窗口_创建完毕
.局部变量 证书, Sunny证书管理器
.局部变量 cert文件路径, 文本型
.局部变量 key文件路径, 文本型
.局部变量 P12文件路径, 文本型
.局部变量 P12文件密码, 文本型
.局部变量 信任的证书文件路径, 文本型


' 任选1即可
' ---------------------------------------------------------------------------
cert文件路径 ＝ “./ssl.pem”
key文件路径 ＝ “./ssl.key”
证书._载入X509KeyPair (cert文件路径, key文件路径)
' 证书._载入X509Certificate (“http://www.baidu.com”, 到文本 (读入文件 (cert文件路径)), 到文本 (读入文件 (key文件路径)))
' 证书._载入P12Certificate (P12文件路径, P12文件密码)
' 证书.创建证书 (, , , “http://www.baidu.com”, )

' ---------------------------------------------------------------------------
' 若要设置双向认证，请设置
' ---------------------------------------------------------------------------
' 证书.添加客户端信任证书_文件 (信任的证书文件路径)
' 证书.设置客户端身份验证模式 (#SSL_ClientAuth_RequireAndVerifyClientCert)
' #SSL_ClientAuth_NoClientCert,                    表示在握手过程中不应该请求客户端证书，并且如果发送了任何证书，它们将不会被验证。
' #SSL_ClientAuth_RequestClientCert                表示应该在握手过程中请求客户端证书，但不要求客户端发送任何证书。
' #SSL_ClientAuth_RequireAnyClientCert             表示在握手过程中应该请求客户端证书，并且客户端至少需要发送一个证书，但该证书不需要有效。
' #SSL_ClientAuth_VerifyClientCertIfGiven          表示应该在握手过程中请求客户端证书，但不要求客户端发送证书。如果客户端发送了一个证书，它就需要是有效的。
' #SSL_ClientAuth_RequireAndVerifyClientCert       表示握手时需要请求客户端证书，客户端至少需要发送一个有效的证书。
' ---------------------------------------------------------------------------


Sunny服务器套件.添加通用路由 (“/”, 取子程序地址 (&Hello))

' :80代表启动的服务器端口为80
' Sunny服务器套件 在模块中 已是全局变量 ,导入模块 可直接使用

' HTTPS配置步骤:
' -            1.首先在阿里云搞定ICP域名备案
' -            2.添加一个子域名
' -            3.给子域名申请免费 SSL 证书, 然后下载证书对应的 pem 和 key 文件.


.判断开始 (Sunny服务器套件.启动HTTPS服务器 (“:8080”, 证书))
    调试输出 (“启动成功”)
.默认
    调试输出 (“启动失败”, Sunny服务器套件.获取运行时的错误信息 ())
.判断结束
' 例如 访问 https://127.0.0.1:8080
' 试试效果
' 提示不安全是正常的，因为证书是自己生成的
' 自签证书问题  请参考 https://www.cnblogs.com/pu369/p/10748684.html

.子程序 Hello
.参数 Context
.局部变量 sunny, Sunny

sunny ＝ 取回sunny对象 (Context)

sunny.响应.写出文本 (#http_Status_OK, “Hello Sunny”)